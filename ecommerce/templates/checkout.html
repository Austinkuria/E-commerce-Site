{% extends "base.html" %}

{% block title %}Checkout{% endblock %}

{% block content %}
<div class="container py-5">
    <h2>Checkout</h2>

    <div class="col-md-6">
        <form method="POST" action="{% url 'checkout' %}">
            {% csrf_token %}
            {{ form.as_p }}

            <!-- Order Summary -->
            <h3>Order Summary</h3>
            {% if checkout_product %}
                <!-- Single Product Checkout -->
                <ul class="list-group">
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        {{ checkout_product.quantity }} x {{ checkout_product.product.name }}: Ksh {{ checkout_product.total_price|floatformat:2 }}
                    </li>
                </ul>
            {% else %}
                <!-- Cart Checkout -->
                <ul class="list-group">
                    {% for item in cart_items %}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        {{ item.quantity }} x {{ item.product.name }}: Ksh {{ item.get_total_price|floatformat:2 }}
                    </li>
                    {% endfor %}
                </ul>
            {% endif %}
            
            <div class="mt-3 text-end">
                <p>Shipping Fee: Ksh {{ shipping_fee|floatformat:2 }}</p>
                <h5>Total: Ksh {{ total_price|floatformat:2 }}</h5>
            </div>

            <button type="submit" class="btn btn-primary mt-3">Place Order</button>
        </form>
    </div>
    
    <!-- Back to index Button -->
    <div class="modal-footer">
        <a href="{% url 'index' %}" class="btn btn-primary">Go Back</a>
    </div>
</div>
{% endblock %}
